05/11/2025 20:33:51 [32m[utils.cpp][0m: [find_input_files] Called with pattern: tpstream
05/11/2025 20:33:51 [32m[utils.cpp][0m: [find_input_files_by_tpstream_basenames] Using 5 basenames from tpstream files (skip=0, max=5)
05/11/2025 20:33:51 [32m[utils.cpp][0m: [find_input_files] Called with pattern: clusters
05/11/2025 20:33:51 [32m[utils.cpp][0m: [find_input_files] clusters_folder_path: /home/virgolaema/dune/online-pointing-utils/data2/prod_cc/clusters_cc_valid_bg_tick3_ch2_min2_tot3_e2p0
05/11/2025 20:33:51 [32m[utils.cpp][0m: [find_input_files_by_tpstream_basenames] Found 5 files matching basenames for pattern 'clusters'
Processing 5 files...

=== File 1: /home/virgolaema/dune/online-pointing-utils/data2/prod_cc/clusters_cc_valid_bg_tick3_ch2_min2_tot3_e2p0/prodmarley_nue_flat_cc_dune10kt_1x2x2_20250926T193931Z_gen_003400_supernova_g4_detsim_ana_2025-10-21T_093319Z_bg_clusters.root ===
05/11/2025 20:33:51 [32m[Clustering.cpp][0m: Reading U clusters from: /home/virgolaema/dune/online-pointing-utils/data2/prod_cc/clusters_cc_valid_bg_tick3_ch2_min2_tot3_e2p0/prodmarley_nue_flat_cc_dune10kt_1x2x2_20250926T193931Z_gen_003400_supernova_g4_detsim_ana_2025-10-21T_093319Z_bg_clusters.root (directory: clusters)
05/11/2025 20:33:52 [33m[Clustering.cpp][0m: TriggerPrimitive version is not 2, be sure to have converted time_peak to samples_to_peak
05/11/2025 20:33:52 [32m[Clustering.cpp][0m:   Loaded 227 U clusters
05/11/2025 20:33:52 [32m[Clustering.cpp][0m: Reading V clusters from: /home/virgolaema/dune/online-pointing-utils/data2/prod_cc/clusters_cc_valid_bg_tick3_ch2_min2_tot3_e2p0/prodmarley_nue_flat_cc_dune10kt_1x2x2_20250926T193931Z_gen_003400_supernova_g4_detsim_ana_2025-10-21T_093319Z_bg_clusters.root (directory: clusters)
05/11/2025 20:33:52 [32m[Clustering.cpp][0m:   Loaded 304 V clusters
05/11/2025 20:33:52 [32m[Clustering.cpp][0m: Reading X clusters from: /home/virgolaema/dune/online-pointing-utils/data2/prod_cc/clusters_cc_valid_bg_tick3_ch2_min2_tot3_e2p0/prodmarley_nue_flat_cc_dune10kt_1x2x2_20250926T193931Z_gen_003400_supernova_g4_detsim_ana_2025-10-21T_093319Z_bg_clusters.root (directory: clusters)
05/11/2025 20:33:52 [32m[Clustering.cpp][0m:   Loaded 317 X clusters
Clusters: U=227 V=304 X=317 (main=43)

--- Main X Cluster 57 ---
Event: 169951, APA: 0
Time range [TDC]: [62624, 66034]
Truth time [TDC]: 62624
Truth pos: (-161.357, 517.543, 103.503)

Nearest U cluster: 3
  Event: 169951 (match: YES)
  APA: 0 (match: YES)
  Time range [TDC]: [62304, 65800]
  Truth time [TDC]: 62304
  Time diff [TDC]: 0
  Truth time diff [TDC]: 320

Nearest V cluster: 15
  Event: 169951 (match: YES)
  APA: 0 (match: YES)
  Time range [TDC]: [62496, 64968]
  Truth time [TDC]: 62496
  Time diff [TDC]: 0
  Truth time diff [TDC]: 128

--- Main X Cluster 433 ---
Event: 169954, APA: 0
Time range [TDC]: [86432, 87828]
Truth time [TDC]: 86432
Truth pos: (-221.187, -357.921, 84.7663)

Nearest U cluster: 374
  Event: 169954 (match: YES)
  APA: 0 (match: YES)
  Time range [TDC]: [86176, 87108]
  Truth time [TDC]: 86176
  Time diff [TDC]: 0
  Truth time diff [TDC]: 256

Nearest V cluster: 391
  Event: 169954 (match: YES)
  APA: 0 (match: YES)
  Time range [TDC]: [86240, 86439]
  Truth time [TDC]: 86240
  Time diff [TDC]: 0
  Truth time diff [TDC]: 192

--- Main X Cluster 514 ---
Event: 169955, APA: 0
Time range [TDC]: [3744, 4623]
Truth time [TDC]: 3744
Truth pos: (13.5554, 537.644, 69.1933)

Nearest U cluster: 477
  Event: 169955 (match: YES)
  APA: 0 (match: YES)
  Time range [TDC]: [3488, 4296]
  Truth time [TDC]: 3488
  Time diff [TDC]: 0
  Truth time diff [TDC]: 256

Nearest V cluster: 257
  Event: 169953 (match: NO)
  APA: 0 (match: YES)
  Time range [TDC]: [4384, 4454]
  Truth time [TDC]: 4384
  Time diff [TDC]: 0
  Truth time diff [TDC]: 640

=== File 2: /home/virgolaema/dune/online-pointing-utils/data2/prod_cc/clusters_cc_valid_bg_tick3_ch2_min2_tot3_e2p0/prodmarley_nue_flat_cc_dune10kt_1x2x2_20250926T193932Z_gen_003401_supernova_g4_detsim_ana_2025-10-21T_095005Z_bg_clusters.root ===
05/11/2025 20:33:52 [32m[Clustering.cpp][0m: Reading U clusters from: /home/virgolaema/dune/online-pointing-utils/data2/prod_cc/clusters_cc_valid_bg_tick3_ch2_min2_tot3_e2p0/prodmarley_nue_flat_cc_dune10kt_1x2x2_20250926T193932Z_gen_003401_supernova_g4_detsim_ana_2025-10-21T_095005Z_bg_clusters.root (directory: clusters)
05/11/2025 20:33:52 [32m[Clustering.cpp][0m:   Loaded 281 U clusters
05/11/2025 20:33:52 [32m[Clustering.cpp][0m: Reading V clusters from: /home/virgolaema/dune/online-pointing-utils/data2/prod_cc/clusters_cc_valid_bg_tick3_ch2_min2_tot3_e2p0/prodmarley_nue_flat_cc_dune10kt_1x2x2_20250926T193932Z_gen_003401_supernova_g4_detsim_ana_2025-10-21T_095005Z_bg_clusters.root (directory: clusters)
05/11/2025 20:33:52 [32m[Clustering.cpp][0m:   Loaded 355 V clusters
05/11/2025 20:33:52 [32m[Clustering.cpp][0m: Reading X clusters from: /home/virgolaema/dune/online-pointing-utils/data2/prod_cc/clusters_cc_valid_bg_tick3_ch2_min2_tot3_e2p0/prodmarley_nue_flat_cc_dune10kt_1x2x2_20250926T193932Z_gen_003401_supernova_g4_detsim_ana_2025-10-21T_095005Z_bg_clusters.root (directory: clusters)
05/11/2025 20:33:52 [32m[Clustering.cpp][0m:   Loaded 358 X clusters
Clusters: U=281 V=355 X=358 (main=42)

--- Main X Cluster 72 ---
Event: 170001, APA: 0
Time range [TDC]: [64544, 67826]
Truth time [TDC]: 64544
Truth pos: (-166.341, 344.039, 434.843)

Nearest U cluster: 7
  Event: 170001 (match: YES)
  APA: 0 (match: YES)
  Time range [TDC]: [64256, 65197]
  Truth time [TDC]: 64256
  Time diff [TDC]: 0
  Truth time diff [TDC]: 288

Nearest V cluster: 22
  Event: 170001 (match: YES)
  APA: 0 (match: YES)
  Time range [TDC]: [64480, 67690]
  Truth time [TDC]: 64480
  Time diff [TDC]: 0
  Truth time diff [TDC]: 64

--- Main X Cluster 197 ---
Event: 170002, APA: 0
Time range [TDC]: [78976, 79837]
Truth time [TDC]: 78976
Truth pos: (-205.947, -376.724, 72.4935)

Nearest U cluster: 133
  Event: 170002 (match: YES)
  APA: 0 (match: YES)
  Time range [TDC]: [78656, 78980]
  Truth time [TDC]: 78656
  Time diff [TDC]: 0
  Truth time diff [TDC]: 320

Nearest V cluster: 149
  Event: 170002 (match: YES)
  APA: 0 (match: YES)
  Time range [TDC]: [78880, 80008]
  Truth time [TDC]: 78880
  Time diff [TDC]: 0
  Truth time diff [TDC]: 96

--- Main X Cluster 348 ---
Event: 170003, APA: 0
Time range [TDC]: [115168, 117044]
Truth time [TDC]: 115168
Truth pos: (-298.536, 507.692, 71.3405)

Nearest U cluster: 262
  Event: 170003 (match: YES)
  APA: 0 (match: YES)
  Time range [TDC]: [114912, 116838]
  Truth time [TDC]: 114912
  Time diff [TDC]: 0
  Truth time diff [TDC]: 256

Nearest V cluster: 282
  Event: 170003 (match: YES)
  APA: 0 (match: YES)
  Time range [TDC]: [115040, 115365]
  Truth time [TDC]: 115040
  Time diff [TDC]: 0
  Truth time diff [TDC]: 128

=== File 3: /home/virgolaema/dune/online-pointing-utils/data2/prod_cc/clusters_cc_valid_bg_tick3_ch2_min2_tot3_e2p0/prodmarley_nue_flat_cc_dune10kt_1x2x2_20250926T193933Z_gen_003402_supernova_g4_detsim_ana_2025-10-21T_092133Z_bg_clusters.root ===
05/11/2025 20:33:52 [32m[Clustering.cpp][0m: Reading U clusters from: /home/virgolaema/dune/online-pointing-utils/data2/prod_cc/clusters_cc_valid_bg_tick3_ch2_min2_tot3_e2p0/prodmarley_nue_flat_cc_dune10kt_1x2x2_20250926T193933Z_gen_003402_supernova_g4_detsim_ana_2025-10-21T_092133Z_bg_clusters.root (directory: clusters)
05/11/2025 20:33:52 [32m[Clustering.cpp][0m:   Loaded 259 U clusters
05/11/2025 20:33:52 [32m[Clustering.cpp][0m: Reading V clusters from: /home/virgolaema/dune/online-pointing-utils/data2/prod_cc/clusters_cc_valid_bg_tick3_ch2_min2_tot3_e2p0/prodmarley_nue_flat_cc_dune10kt_1x2x2_20250926T193933Z_gen_003402_supernova_g4_detsim_ana_2025-10-21T_092133Z_bg_clusters.root (directory: clusters)
05/11/2025 20:33:52 [32m[Clustering.cpp][0m:   Loaded 334 V clusters
05/11/2025 20:33:52 [32m[Clustering.cpp][0m: Reading X clusters from: /home/virgolaema/dune/online-pointing-utils/data2/prod_cc/clusters_cc_valid_bg_tick3_ch2_min2_tot3_e2p0/prodmarley_nue_flat_cc_dune10kt_1x2x2_20250926T193933Z_gen_003402_supernova_g4_detsim_ana_2025-10-21T_092133Z_bg_clusters.root (directory: clusters)
05/11/2025 20:33:52 [32m[Clustering.cpp][0m:   Loaded 342 X clusters
Clusters: U=259 V=334 X=342 (main=46)

--- Main X Cluster 116 ---
Event: 170051, APA: 0
Time range [TDC]: [121312, 121847]
Truth time [TDC]: 121312
Truth pos: (311.057, -548.044, 375.739)

Nearest U cluster: 12
  Event: 170051 (match: YES)
  APA: 0 (match: YES)
  Time range [TDC]: [121504, 121673]
  Truth time [TDC]: 121504
  Time diff [TDC]: 0
  Truth time diff [TDC]: 192

Nearest V cluster: 1761
  Event: 170065 (match: NO)
  APA: 0 (match: YES)
  Time range [TDC]: [121664, 121702]
  Truth time [TDC]: 121664
  Time diff [TDC]: 0
  Truth time diff [TDC]: 352

--- Main X Cluster 214 ---
Event: 170052, APA: 0
Time range [TDC]: [41792, 43434]
Truth time [TDC]: 41792
Truth pos: (109.219, -327.371, 185.71)

Nearest U cluster: 166
  Event: 170052 (match: YES)
  APA: 0 (match: YES)
  Time range [TDC]: [41184, 41928]
  Truth time [TDC]: 41184
  Time diff [TDC]: 0
  Truth time diff [TDC]: 608

Nearest V cluster: 184
  Event: 170052 (match: YES)
  APA: 0 (match: YES)
  Time range [TDC]: [41664, 43241]
  Truth time [TDC]: 41664
  Time diff [TDC]: 0
  Truth time diff [TDC]: 128

--- Main X Cluster 337 ---
Event: 170053, APA: 0
Time range [TDC]: [44512, 45200]
Truth time [TDC]: 44512
Truth pos: (-118.006, 240.653, 47.0243)

Nearest U cluster: 1040
  Event: 170059 (match: NO)
  APA: 0 (match: YES)
  Time range [TDC]: [44608, 45160]
  Truth time [TDC]: 44608
  Time diff [TDC]: 0
  Truth time diff [TDC]: 96

Nearest V cluster: 303
  Event: 170053 (match: YES)
  APA: 0 (match: YES)
  Time range [TDC]: [44352, 45000]
  Truth time [TDC]: 44352
  Time diff [TDC]: 0
  Truth time diff [TDC]: 160

=== File 4: /home/virgolaema/dune/online-pointing-utils/data2/prod_cc/clusters_cc_valid_bg_tick3_ch2_min2_tot3_e2p0/prodmarley_nue_flat_cc_dune10kt_1x2x2_20250926T193935Z_gen_003403_supernova_g4_detsim_ana_2025-10-21T_090629Z_bg_clusters.root ===
05/11/2025 20:33:52 [32m[Clustering.cpp][0m: Reading U clusters from: /home/virgolaema/dune/online-pointing-utils/data2/prod_cc/clusters_cc_valid_bg_tick3_ch2_min2_tot3_e2p0/prodmarley_nue_flat_cc_dune10kt_1x2x2_20250926T193935Z_gen_003403_supernova_g4_detsim_ana_2025-10-21T_090629Z_bg_clusters.root (directory: clusters)
05/11/2025 20:33:52 [32m[Clustering.cpp][0m:   Loaded 262 U clusters
05/11/2025 20:33:52 [32m[Clustering.cpp][0m: Reading V clusters from: /home/virgolaema/dune/online-pointing-utils/data2/prod_cc/clusters_cc_valid_bg_tick3_ch2_min2_tot3_e2p0/prodmarley_nue_flat_cc_dune10kt_1x2x2_20250926T193935Z_gen_003403_supernova_g4_detsim_ana_2025-10-21T_090629Z_bg_clusters.root (directory: clusters)
05/11/2025 20:33:52 [32m[Clustering.cpp][0m:   Loaded 337 V clusters
05/11/2025 20:33:52 [32m[Clustering.cpp][0m: Reading X clusters from: /home/virgolaema/dune/online-pointing-utils/data2/prod_cc/clusters_cc_valid_bg_tick3_ch2_min2_tot3_e2p0/prodmarley_nue_flat_cc_dune10kt_1x2x2_20250926T193935Z_gen_003403_supernova_g4_detsim_ana_2025-10-21T_090629Z_bg_clusters.root (directory: clusters)
05/11/2025 20:33:52 [32m[Clustering.cpp][0m:   Loaded 350 X clusters
Clusters: U=262 V=337 X=350 (main=48)

--- Main X Cluster 96 ---
Event: 170101, APA: 0
Time range [TDC]: [141472, 141990]
Truth time [TDC]: 141472
Truth pos: (-359.056, -408.274, 143.591)

Nearest U cluster: 3254
  Event: 170128 (match: NO)
  APA: 0 (match: YES)
  Time range [TDC]: [142016, 142023]
  Truth time [TDC]: 142016
  Time diff [TDC]: 26
  Truth time diff [TDC]: 544

Nearest V cluster: 23
  Event: 170101 (match: YES)
  APA: 0 (match: YES)
  Time range [TDC]: [141344, 141543]
  Truth time [TDC]: 141344
  Time diff [TDC]: 0
  Truth time diff [TDC]: 128

--- Main X Cluster 231 ---
Event: 170102, APA: 0
Time range [TDC]: [134528, 135567]
Truth time [TDC]: 134528
Truth pos: (-342.081, -20.4771, 250.031)

Nearest U cluster: 125
  Event: 170102 (match: YES)
  APA: 0 (match: YES)
  Time range [TDC]: [134048, 135209]
  Truth time [TDC]: 134048
  Time diff [TDC]: 0
  Truth time diff [TDC]: 480

Nearest V cluster: 146
  Event: 170102 (match: YES)
  APA: 0 (match: YES)
  Time range [TDC]: [134304, 135399]
  Truth time [TDC]: 134304
  Time diff [TDC]: 0
  Truth time diff [TDC]: 224

--- Main X Cluster 303 ---
Event: 170103, APA: 0
Time range [TDC]: [84992, 85204]
Truth time [TDC]: 84992
Truth pos: (217.401, 83.7279, 362.567)

Nearest U cluster: 4414
  Event: 170137 (match: NO)
  APA: 0 (match: YES)
  Time range [TDC]: [84736, 84783]
  Truth time [TDC]: 84736
  Time diff [TDC]: 209
  Truth time diff [TDC]: 256

Nearest V cluster: 268
  Event: 170103 (match: YES)
  APA: 0 (match: YES)
  Time range [TDC]: [84864, 85194]
  Truth time [TDC]: 84864
  Time diff [TDC]: 0
  Truth time diff [TDC]: 128

=== File 5: /home/virgolaema/dune/online-pointing-utils/data2/prod_cc/clusters_cc_valid_bg_tick3_ch2_min2_tot3_e2p0/prodmarley_nue_flat_cc_dune10kt_1x2x2_20250926T193937Z_gen_003404_supernova_g4_detsim_ana_2025-10-21T_093735Z_bg_clusters.root ===
05/11/2025 20:33:52 [32m[Clustering.cpp][0m: Reading U clusters from: /home/virgolaema/dune/online-pointing-utils/data2/prod_cc/clusters_cc_valid_bg_tick3_ch2_min2_tot3_e2p0/prodmarley_nue_flat_cc_dune10kt_1x2x2_20250926T193937Z_gen_003404_supernova_g4_detsim_ana_2025-10-21T_093735Z_bg_clusters.root (directory: clusters)
05/11/2025 20:33:52 [32m[Clustering.cpp][0m:   Loaded 272 U clusters
05/11/2025 20:33:52 [32m[Clustering.cpp][0m: Reading V clusters from: /home/virgolaema/dune/online-pointing-utils/data2/prod_cc/clusters_cc_valid_bg_tick3_ch2_min2_tot3_e2p0/prodmarley_nue_flat_cc_dune10kt_1x2x2_20250926T193937Z_gen_003404_supernova_g4_detsim_ana_2025-10-21T_093735Z_bg_clusters.root (directory: clusters)
05/11/2025 20:33:52 [32m[Clustering.cpp][0m:   Loaded 355 V clusters
05/11/2025 20:33:52 [32m[Clustering.cpp][0m: Reading X clusters from: /home/virgolaema/dune/online-pointing-utils/data2/prod_cc/clusters_cc_valid_bg_tick3_ch2_min2_tot3_e2p0/prodmarley_nue_flat_cc_dune10kt_1x2x2_20250926T193937Z_gen_003404_supernova_g4_detsim_ana_2025-10-21T_093735Z_bg_clusters.root (directory: clusters)
05/11/2025 20:33:52 [32m[Clustering.cpp][0m:   Loaded 356 X clusters
Clusters: U=272 V=355 X=356 (main=46)

--- Main X Cluster 96 ---
Event: 170151, APA: 0
Time range [TDC]: [96672, 97518]
Truth time [TDC]: 96672
Truth pos: (-240.99, 402.859, 233.689)

Nearest U cluster: 10
  Event: 170151 (match: YES)
  APA: 0 (match: YES)
  Time range [TDC]: [96416, 97224]
  Truth time [TDC]: 96416
  Time diff [TDC]: 0
  Truth time diff [TDC]: 256

Nearest V cluster: 34
  Event: 170151 (match: YES)
  APA: 0 (match: YES)
  Time range [TDC]: [97184, 97382]
  Truth time [TDC]: 97184
  Time diff [TDC]: 0
  Truth time diff [TDC]: 512

--- Main X Cluster 236 ---
Event: 170152, APA: 0
Time range [TDC]: [127744, 131980]
Truth time [TDC]: 127744
Truth pos: (339.553, -156.18, 431.109)

Nearest U cluster: 154
  Event: 170152 (match: YES)
  APA: 0 (match: YES)
  Time range [TDC]: [128256, 128456]
  Truth time [TDC]: 128256
  Time diff [TDC]: 0
  Truth time diff [TDC]: 512

Nearest V cluster: 176
  Event: 170152 (match: YES)
  APA: 0 (match: YES)
  Time range [TDC]: [128352, 128392]
  Truth time [TDC]: 128352
  Time diff [TDC]: 0
  Truth time diff [TDC]: 608

--- Main X Cluster 371 ---
Event: 170153, APA: 0
Time range [TDC]: [130240, 131787]
Truth time [TDC]: 130240
Truth pos: (-330.923, 403.655, 235.376)

Nearest U cluster: 155
  Event: 170152 (match: NO)
  APA: 0 (match: YES)
  Time range [TDC]: [131616, 131685]
  Truth time [TDC]: 131616
  Time diff [TDC]: 0
  Truth time diff [TDC]: 1376

Nearest V cluster: 300
  Event: 170153 (match: YES)
  APA: 0 (match: YES)
  Time range [TDC]: [130144, 130697]
  Truth time [TDC]: 130144
  Time diff [TDC]: 0
  Truth time diff [TDC]: 96


=== SUMMARY ===
Total main X clusters analyzed: 15

Nearest U cluster analysis:
  Event mismatches: 4/15
  APA mismatches: 0/15
  Within 1000 TDC ticks: 15/15

Nearest V cluster analysis:
  Event mismatches: 2/15
  APA mismatches: 0/15
  Within 1000 TDC ticks: 15/15
